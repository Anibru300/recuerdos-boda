<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>

<h3>Formulario con foto</h3>

<input type="text" id="nombre" placeholder="Nombre"><br><br>
<input type="email" id="correo" placeholder="Correo"><br><br>
<textarea id="comentario" placeholder="Comentario"></textarea><br><br>

<input type="file" id="foto" accept="image/*"><br><br>

<button type="button" onclick="enviar()">Enviar</button>

<p id="estado"></p>

<script>
function enviar() {
  const estado = document.getElementById("estado");
  estado.innerText = "Procesando...";

  const fileInput = document.getElementById("foto");

  if (!fileInput.files.length) {
    estado.innerText = "❌ No seleccionaste ninguna foto";
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function () {
    fetch("https://script.google.com/macros/s/AKfycbw3SsyyINpLH2oBxgw4Kcrr3haGdkM9yoyrZ42lj6QZmUGrk_jf4AsEWQFx4nKakyZmOA/exec", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        nombre: document.getElementById("nombre").value,
        correo: document.getElementById("correo").value,
        comentario: document.getElementById("comentario").value,
        fotoBase64: reader.result,
        fotoNombre: file.name
      })
    })
    .then(res => res.json())
    .then(res => {
      if (res.ok) {
        estado.innerText = "✅ Enviado correctamente";
      } else {
        estado.innerText = "❌ Error: " + res.error;
      }
    })
    .catch(err => {
      estado.innerText = "❌ Error de red";
      console.error(err);
    });
  };

  reader.onerror = function () {
    estado.innerText = "❌ Error al leer la imagen";
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
